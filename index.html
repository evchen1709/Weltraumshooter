<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Weltraum Shooter</title>
<meta name="theme-color" content="#0a0a2e">
<link rel="manifest" href="manifest.webmanifest">
<link rel="apple-touch-icon" href="icons/icon-192.png">
<style>
body{margin:0;overflow:hidden;background:#000;color:#0f8;font-family:sans-serif}
.game{position:relative;width:100vw;height:100vh;outline:none}
.player{position:absolute;bottom:50px;left:50%;transform:translateX(-50%);width:60px;height:60px}
.enemy{position:absolute}
.bullet,.enemy-bullet{position:absolute;width:6px;height:16px;border-radius:3px}
.bullet{background:#6f6}
.enemy-bullet{background:#f44}
.hud{position:absolute;top:10px;left:10px;background:rgba(0,0,0,.4);padding:8px 12px;border-radius:8px}
.over{display:none;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#000a;padding:20px;border-radius:12px;text-align:center;color:#fff}
button{padding:8px 16px;border-radius:6px;border:0;background:#6f6;color:#000;font-weight:bold}
</style>
</head>
<body>
<div class="game" id="root" tabindex="0">
  <div class="hud">üéØ <span id="score">0</span> | ‚ù§Ô∏è <span id="lives">3</span> | üåä <span id="wave">1</span></div>
  <div class="player" id="player">
    <svg viewBox="0 0 60 60" width="60" height="60"><path d="M30,3 L42,18 L45,35 L42,48 L35,52 L25,52 L18,48 L15,35 L18,18 Z" fill="#ccc" stroke="#fff"/></svg>
  </div>
  <div class="over" id="over">SPIEL VORBEI<br>Score: <span id="final">0</span><br><button onclick="restartGame()">Restart</button></div>
</div>
<script>
if('serviceWorker' in navigator){window.addEventListener('load',()=>navigator.serviceWorker.register('./sw.js'));}
const root=document.getElementById('root'),player=document.getElementById('player');
const scoreEl=document.getElementById('score'),livesEl=document.getElementById('lives'),waveEl=document.getElementById('wave');
const over=document.getElementById('over'),final=document.getElementById('final');
let state={x:innerWidth/2-30,score:0,lives:3,wave:1,run:true,bullets:[],enemies:[],keys:{},last:0,spawn:0};
player.style.left=state.x+'px';
document.addEventListener('keydown',e=>{state.keys[e.code]=true; if(['ArrowLeft','ArrowRight','Space'].includes(e.code)) e.preventDefault();});
document.addEventListener('keyup',e=>state.keys[e.code]=false);
root.addEventListener('pointerdown',()=>state.keys['Space']=true);
root.addEventListener('pointerup',()=>state.keys['Space']=false);
root.addEventListener('pointermove',e=>{state.x=Math.max(0,Math.min(innerWidth-60,e.clientX-30)); player.style.left=state.x+'px';});
function move(){if(state.keys['ArrowLeft'])state.x=Math.max(0,state.x-8);if(state.keys['ArrowRight'])state.x=Math.min(innerWidth-60,state.x+8);player.style.left=state.x+'px';}
function shoot(){if(state.keys['Space']&&Date.now()-state.last>250){const b=document.createElement('div');b.className='bullet';b.style.left=(state.x+28)+'px';b.style.bottom='110px';root.appendChild(b);state.bullets.push({el:b,x:state.x+28,y:innerHeight-110});state.last=Date.now();}}
function mkEnemy(){let w=40,h=40;const e=document.createElement('div');e.className='enemy';e.style.width=w+'px';e.style.height=h+'px';let x=Math.random()*(innerWidth-w);e.style.left=x+'px';e.style.top='0px';e.innerHTML='<svg viewBox="0 0 40 40"><circle cx="20" cy="20" r="15" fill="red"/></svg>';root.appendChild(e);state.enemies.push({el:e,x:x,y:0,w:w,h:h});}
function loop(){if(!state.run)return;move();shoot();if(Date.now()-state.spawn>1200){mkEnemy();state.spawn=Date.now();}
let nb=[];for(let b of state.bullets){b.y-=10;b.el.style.bottom=(innerHeight-b.y)+'px';if(b.y>0)nb.push(b);else b.el.remove();}state.bullets=nb;
let ne=[];for(let e of state.enemies){e.y+=2;e.el.style.top=e.y+'px';if(e.y<innerHeight){ne.push(e);}else e.el.remove();}state.enemies=ne;
// collisions
for(let bi=state.bullets.length-1;bi>=0;bi--){const b=state.bullets[bi];for(let ei=state.enemies.length-1;ei>=0;ei--){const e=state.enemies[ei];if(b.x>e.x&&b.x<e.x+e.w&&b.y>e.y&&b.y<e.y+e.h){b.el.remove();state.bullets.splice(bi,1);e.el.remove();state.enemies.splice(ei,1);state.score+=10;scoreEl.textContent=state.score;break;}}}
// enemies vs player
for(let ei=state.enemies.length-1;ei>=0;ei--){const e=state.enemies[ei];if(e.y>innerHeight-100&&e.x>state.x-20&&e.x<state.x+60){e.el.remove();state.enemies.splice(ei,1);state.lives--;livesEl.textContent=state.lives;if(state.lives<=0){state.run=false;over.style.display='block';final.textContent=state.score;}}}
requestAnimationFrame(loop);}
loop();
function restartGame(){document.querySelectorAll('.bullet,.enemy').forEach(el=>el.remove());state={x:innerWidth/2-30,score:0,lives:3,wave:1,run:true,bullets:[],enemies:[],keys:{},last:0,spawn:0};scoreEl.textContent='0';livesEl.textContent='3';waveEl.textContent='1';over.style.display='none';player.style.left=state.x+'px';loop();}
</script>
</body>
</html>
